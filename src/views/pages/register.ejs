<%- include('../partials/head') %>
<%- include('../partials/header') %>

<section class="container auth-split" data-animate="fade">
  <div class="split-card" data-animate="fade-up">
    <div class="split-left">
      <div class="hero">
        <div class="hero-illus">ğŸš€</div>
        <h3>Plan your activities and control your progress online</h3>
        <p>Gia nháº­p TechShop Blue Ä‘á»ƒ mua sáº¯m nhanh chÃ³ng, tiá»‡n lá»£i.</p>
        <div class="dots"><span></span><span></span><span></span><span></span></div>
      </div>
    </div>
    <div class="split-right">
      <div class="header-row">
        <a class="muted" href="/login">Sign In</a>
      </div>
      <h2 class="split-title">Sign Up</h2>

  <% if (locals.flash && flash.success && flash.success.length) { %>
    <div class="alert success" data-animate="fade-up">
      <%= flash.success[0] %>
    </div>
  <% } %>

  <% if (typeof error !== 'undefined' && error) { %>
    <div class="alert error" data-animate="fade-up"><%= error %></div>
  <% } %>

      <form method="post" action="/register" 
        class="auth-form" 
        data-animate="fade-up" 
        data-duration="700">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>"/>

        <label>Email</label>
        <input type="email" name="email" required placeholder="you@example.com"/>

        <label>Username</label>
        <input name="username" required placeholder="yourname"/>

        <label>Máº­t kháº©u</label>
        <div class="password-wrapper">
          <input type="password" name="password" id="password" required minlength="6" placeholder="Tá»‘i thiá»ƒu 6 kÃ½ tá»±"/>
          <button type="button" class="toggle-password" data-target="password" aria-label="Hiá»‡n máº­t kháº©u">ğŸ‘</button>
        </div>

        <label>XÃ¡c nháº­n máº­t kháº©u</label>
        <div class="password-wrapper">
          <input type="password" name="confirm" id="confirm" minlength="6" placeholder="Nháº­p láº¡i máº­t kháº©u"/>
          <button type="button" class="toggle-password" data-target="confirm" aria-label="Hiá»‡n máº­t kháº©u">ğŸ‘</button>
        </div>

        <button class="btn btn-primary w-full" data-animate="zoom-in">Táº¡o tÃ i khoáº£n</button>

    <p class="muted text-center" style="margin-top:1rem">
      ÄÃ£ cÃ³ tÃ i khoáº£n? <a href="/login" class="link">ÄÄƒng nháº­p</a>
    </p>
        <div style="margin-top:1.2rem" data-animate="fade-up" data-delay="120">
          <a class="btn btn-outline w-full" href="/auth/google" style="margin-bottom:.5rem">
            <i class="ri-google-fill" style="color:#db4437"></i> ÄÄƒng kÃ½ vá»›i Google
          </a>
          <a class="btn btn-outline w-full" href="/auth/facebook">
            <i class="ri-facebook-circle-fill" style="color:#1877f2"></i> ÄÄƒng kÃ½ vá»›i Facebook
          </a>
        </div>
      </form>
    </div>
  </div>
</section>

<%- include('../partials/footer') %>

<script>
  // ğŸ‘ Toggle hiá»ƒn thá»‹ máº­t kháº©u
  document.querySelectorAll(".toggle-password").forEach(btn => {
    btn.addEventListener("click", () => {
      const target = document.getElementById(btn.getAttribute("data-target"));
      if (target.type === "password") {
        target.type = "text";
        btn.textContent = "ğŸ™ˆ";
      } else {
        target.type = "password";
        btn.textContent = "ğŸ‘";
      }
    });
  });
</script>

<style>
  .auth-split { margin: 2rem auto; }
  .split-card { display: grid; grid-template-columns: 1.1fr 1fr; border: 1px solid var(--border); border-radius: 1.2rem; overflow: hidden; box-shadow: var(--shadow-md); background: var(--elev); }
  .split-left { background: linear-gradient(180deg, #59e0c5, #24c1a5); color: #083a3a; padding: 2rem; display:flex; align-items:center; justify-content:center; }
  .split-left .hero { max-width: 420px; text-align: center; }
  .hero-illus { font-size: 3rem; margin-bottom: .6rem; }
  .split-left h3 { margin: .3rem 0; font-size: 1.2rem; color: #0b3c3c; }
  .split-left p { color: #0b544e; }
  .dots { margin-top: 1.2rem; display:flex; gap:.3rem; justify-content:center; opacity:.7; }
  .dots span { width:6px; height:6px; background:#0b544e; border-radius:50%; display:inline-block; }
  .split-right { padding: 2rem; background: var(--elev); }
  .header-row { display:flex; justify-content:flex-end; }
  .split-title { margin: .2rem 0 1rem; color: var(--primary); }
  .auth-form { display:flex; flex-direction:column; gap:.65rem; }
  .header-row a { text-decoration:none; font-weight:700; color: var(--primary-700); background: var(--primary-100); padding:.35rem .8rem; border-radius:999px; border:1px solid var(--border); }
  .header-row a:hover { background: var(--primary); color:#fff; border-color: var(--primary); }
  .theme-dark .header-row a { color:#e6efff; background: rgba(255,255,255,0.08); border-color:#2a3b5c; }

  /* === CÃC DÃ’NG DÆ¯á»šI ÄÃ‚Y ÄÃƒ Bá»Š XÃ“A VÃŒ ÄÆ¯á»¢C main.css Xá»¬ LÃ ===
   .input-control { ... }
   .input-control:focus { ... }
  */

  /* ğŸ‘ password wrapper */
  .password-wrapper {
    position: relative;
  }
  
  /* Cáº§n giá»¯ láº¡i .toggle-password vÃ¬ nÃ³ náº±m bÃªn trong .password-wrapper */
  .password-wrapper .toggle-password {
    position: absolute;
    right: .6rem;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1rem;
    color: var(--muted);
    transition: color .2s ease;
  }

  .toggle-password:hover {
    color: var(--primary);
  }

  .btn.w-full { width: 100%; }

  /* Alert flash */
  .alert {
    border-radius: .5rem;
    padding: .75rem 1rem;
    margin-bottom: .8rem;
    animation: fadeIn .4s ease;
  }

  .alert.success {
    background: #dcfce7;
    color: #14532d;
    border-left: 4px solid #22c55e;
  }

  .alert.error {
    background: #fee2e2;
    color: #991b1b;
    border-left: 4px solid #ef4444;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-6px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @media (prefers-color-scheme: dark) {
    .auth.section {
      background: rgba(255,255,255,0.05);
      box-shadow: 0 8px 24px rgba(0,0,0,0.5);
    }
    
    /* === ÄÃƒ XÃ“A .input-control á»Ÿ cháº¿ Ä‘á»™ dark === */
    
    .toggle-password {
      color: #9ca3af;
    }
  }
</style>