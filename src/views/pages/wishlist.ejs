<%- include('../partials/head') %>
<%- include('../partials/header') %>

<section class="container section wishlist-page" data-animate="fade">
  <h2 class="section-title" data-animate="fade-up">üíô Danh s√°ch y√™u th√≠ch</h2>

  <% if (!items.length) { %>
    <div class="empty glass-box" data-animate="zoom-in">
      <img src="/public/img/empty-wishlist.svg" alt="Danh s√°ch r·ªóng" class="empty-img"/>
      <p>B·∫°n ch∆∞a th√™m s·∫£n ph·∫©m n√†o v√†o danh s√°ch y√™u th√≠ch.</p>
      <a href="/" class="btn btn-primary" data-animate="fade-up" data-delay="100">‚¨Ö Ti·∫øp t·ª•c mua s·∫Øm</a>
    </div>
  <% } else { %>
    <div class="grid4" data-skeleton="true">
      <% items.forEach((p, i) => { %>
        <div class="wishlist-card glass-card" data-animate="fade-up" data-delay="<%= i * 80 %>">
          <img src="<%= p.cover_image_url || '/public/img/placeholder.png' %>" alt="<%= p.name %>" class="wishlist-img"/>
          <h3 class="wishlist-title"><%= p.name %></h3>
          <div class="price">
            <% if (p.sale_price) { %>
              <span class="old"><%= p.price.toLocaleString() %>‚Ç´</span>
            <% } %>
            <span class="now"><%= (p.sale_price || p.price).toLocaleString() %>‚Ç´</span>
          </div>
          <div class="wishlist-actions">
            <a href="/p/<%= p.slug %>" class="btn btn-outline small">Xem</a>
            <form action="/cart/add" method="post" class="inline">
              <input type="hidden" name="_csrf" value="<%= csrfToken %>"/>
              <input type="hidden" name="product_id" value="<%= p.id %>"/>
              <button class="btn btn-primary small">üõí Th√™m v√†o gi·ªè</button>
            </form>
            <form action="/wishlist/remove" method="post" class="inline">
              <input type="hidden" name="_csrf" value="<%= csrfToken %>"/>
              <input type="hidden" name="product_id" value="<%= p.id %>"/>
              <button class="btn btn-outline danger small">X√≥a</button>
            </form>
          </div>
        </div>
      <% }) %>
    </div>
  <% } %>
</section>

<%- include('../partials/footer') %>

<style>
  .wishlist-page { max-width: 1100px; margin: 2rem auto; }

  .glass-box {
    background: rgba(255,255,255,0.08);
    border: 1px solid var(--border);
    border-radius: 1rem;
    padding: 2rem;
    text-align: center;
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    backdrop-filter: blur(10px);
  }

  .glass-card {
    background: rgba(255,255,255,0.08);
    border: 1px solid var(--border);
    border-radius: .8rem;
    padding: 1rem;
    text-align: center;
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    transition: transform .3s ease, box-shadow .3s ease;
    backdrop-filter: blur(10px);
  }

  .glass-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0,0,0,0.25);
  }

  .wishlist-img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: .5rem;
    margin-bottom: .8rem;
  }

  .wishlist-title {
    font-size: 1rem;
    margin: .4rem 0;
    color: var(--primary-700);
  }

  .price {
    margin: .3rem 0 .7rem;
    font-size: .95rem;
  }

  .price .old {
    text-decoration: line-through;
    color: var(--muted);
    margin-right: .4rem;
  }

  .wishlist-actions {
    display: flex;
    justify-content: space-between;
    gap: .4rem;
    flex-wrap: wrap;
  }

  .btn.small {
    padding: .4rem .7rem;
    font-size: .85rem;
  }

  .empty-img {
    width: 180px;
    opacity: .9;
    margin-bottom: 1rem;
  }

  @media (prefers-color-scheme: dark) {
    .glass-card, .glass-box {
      background: rgba(255,255,255,0.05);
      box-shadow: 0 8px 24px rgba(0,0,0,0.5);
    }
  }

  @media (max-width: 768px) {
    .grid4 { grid-template-columns: repeat(2, 1fr); }
    .wishlist-actions { flex-direction: column; align-items: stretch; }
    .btn.small { width: 100%; }
  }
</style>
